<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Alertify sakit sa ulo -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/alertify.min.css"/>
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/bootstrap.min.css"/>
    <!-- Sweet -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

    <script src="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
    <script src="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="icon" type="image/x-icon" href="img/logo.ico">

    <style>
          .navbar {
            background-color: #008000; 
            transition: background-color 0.3s ease; 
          }
         
          .nav-link {
            color: white;
            font-weight: 500;
            transition: color 0.3s ease 
          }
          .nav-link.scrolled:hover {
            color: #006341; 
            font-weight: 500;
          }
         
          .login__bg{
            position: absolute;
            width: 100%;
            height: 110%;
            object-fit: cover;
            object-position: center;
            z-index: -1;
          }
          .login_card{
            height: 90%;
            border-radius: 6px;
            background-color: rgba(255, 255, 255, 0.385); 
            backdrop-filter: blur(10px); 
            box-shadow: rgba(0, 0, 0, 0.3) 0px 19px 38px, rgba(0, 0, 0, 0.22) 0px 15px 12px;
          }
         
    </style>
</head>
<body>
     <!--Navbar-->
     <nav class="navbar navbar-expand-lg shadow-lg sticky-top" id="navbar">
        <div class="container-sm d-flex justify-content-between" style="width: 100%">
  
          <div class="d-flex justify-content-between align-items-center" style="width: 100vw">
            <div>
              <!-- for logo -->
              <img src="img/logo.png" alt="" style="width: 60px;" /> 
            </div>
            <h3 class="flex-start fw-bold" >Library Users Registration</h3>
            <div>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent">
                <i class="fa-solid fa-bars" id="mugIcon"></i>
              </button>
            </div>
          </div>
      
        </div>
      </nav>
      <!--End ti Navbar -->

      <img src="img/bg.jpg" alt="image" class="login__bg" >

      
      <!-- LOGIN FORM -->
    <section class="vh-100">
        <div class="container d-flex justify-content-center align-items-center h-100">
            <div class="col-12 col-md-6 col-lg-4">
                <div class="login_card card">
                    <form enctype="multipart/form-data" method="POST" class="mt-1">
                        <div class="m-5">
                            <div class="form-group d-flex justify-content-center my-5">
                                <img src="img/logo.png" alt="LOGO" style="width: 90px;">
                            </div>
                            <div class="form-group my-4">
                                <label for="Name" style="font-weight: 700;">Username</label>
                                <input type="text" name="studentName" id="studentName" placeholder="Enter Username" class="form-control" required>
                            </div>
                            <div class="form-group my-4">
                                <label for="pass" style="font-weight: 700;">Password</label>
                                <input type="password" name="studentPassword" id="studentPassword" placeholder="Enter Password" class="form-control" required>
                            </div>
                            <div class="col-sm">
                                <p style="font-size: 13px; color: rgb(0, 0, 0);">
                                    Don't have an account?
                                    <a data-bs-toggle="modal" data-bs-target="#exampleModal" style="text-overflow: unset; color: rgb(252, 254, 255); text-decoration: none;" onmouseover="this.style.textDecoration='underline'" onmouseout="this.style.textDecoration='none'">
                                        Sign up
                                    </a>
                                </p>
                            </div>
                            <div class="form-group row justify-content-end">
                                <div class="col-auto">
                                    <button type="button" id="addProductButton" class="btn btn-outline-light" onclick="Login()">Login</button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
    <!-- End LOgin FOrm -->

      <!-- MODAL -->

      <div id="modalContainer"></div>

      <!-- END MODAL -->

      
    
      <!---Footer-->
      <footer class="mt-5 text-white p-3" style="background-color: #008000;">
        <div class="container-sm d-flex justify-content-between align-items-center">
          <div class="">
            <h4>ISPSC Library Management System</h4>
            <h5>CCSIT 210</h5>
            <ul>
              <li>Dran Leynard Gamoso</li>
              <li>Dran Leynard Gamoso</li>
            </ul>
          </div>
          <div class="">
            <div>
              <img src="./img/logo.png" style=" width: 50px; height: 50px;" alt="">
            </div>
            <div>
              <p class="fst-bold">&copy DL Visuals</p>
            </div>
          </div>
        </div>
      </footer>
     <!---End Footer-->

 
     <script type="text/javascript">
      alertify.set('notifier', 'position', 'top-right');

      $(document).ready(function () {
        $('#modalContainer').load('modal.html');
      });
    
     
      //form validation
      function Login() {
          var username = document.getElementById("studentName").value;
          var password = document.getElementById("studentPassword").value;
      
          if (username == "" && password == "") {
              alertify.error('Empty fields! Please fill all the fields.');
          } else if (username == "") {
              alertify.error('Fill up the Username field!');
          } else if (password == "") {
              alertify.error('Fill up the Password field!');
          } else {
              // Send form data to loginProcess.php using AJAX
              $.ajax({
                  type: "POST",
                  url: "process/loginProcess.php",
                  data: {
                      studentLoginName: username,
                      studentLoginPassword: password
                  },
                  dataType: "json",
                  success: function(response) {
                      // Handle success response
                      if (response.status === 'success') {

                          // if login goods 
                          //alertify.success(response.message + ' <i class="fa fa-spinner fa-spin"></i>');
                          Swal.fire({
                            icon: 'success',
                            title: response.message,
                            showConfirmButton: false,
                            timer: 2000 
                          });
                          

                          var customerID = response.id;
                          sessionStorage.setItem('studentID', customerID);
      
                          var customerNameInput = document.getElementById("studentName").value;
                          var customerName = customerNameInput;
                          sessionStorage.setItem('studentName', customerName); //tangina  40mins para dito
      
                          setTimeout(function() {

                              if (response.type === 'admin') {
                                  window.location.href = 'admin.html'; 
                              } else {
                                  window.location.href = 'home.html'; 
                              }

                          }, 2000);
      
                      } else {
                        //  alertify.error(response.message);// Display error message 
                          Swal.fire({
                            icon: 'error',
                            title: response.message,
                            showConfirmButton: false,
                            timer: 1500 
                          });
                          
                      }
                  },
                  error: function(xhr, status, error) {
                      console.error(xhr.responseText);
                      alertify.error('Failed to log in!');
                  }
              });
          }
      }
    

    function Signup() {
        // Get form data
        var studentSignUpidNumber = $("#studentSignUpidNumber").val();
        var studentSignUpName = $("#studentSignUpName").val();
        var studentSignUpUsername = $("#studentSignUpUsername").val();
        var studentDepartment = $("#studentDepartment").val();
        var studentSignUpPassword = $("#studentSignUpPassword").val();
        var checkSignUpPassword = $("#checkSignUpPassword").val();
    
        // Check if passwords match
        if (studentSignUpPassword !== checkSignUpPassword) {
            alertify.error('Passwords do not match!');
            return; 
        }
    
        // Check for empty fields
        if (studentSignUpidNumber === "" || studentSignUpName === "" || studentSignUpUsername === "" || studentDepartment === "" || studentSignUpPassword === "" || checkSignUpPassword === "") {
            alertify.error('Empty fields! Please fill all the fields.');
        } else {
            // Log data being sent to server
            console.log({
                studentSignUpidNumber: studentSignUpidNumber,
                studentSignUpName: studentSignUpName,
                studentSignUpUsername: studentSignUpUsername,
                studentDepartment: studentDepartment,
                studentSignUpPassword: studentSignUpPassword
            });
    
            // Make AJAX request
            $.ajax({
                type: "POST",
                url: "process/signupProcess.php",
                data: {
                    studentSignUpidNumber: studentSignUpidNumber,
                    studentSignUpName: studentSignUpName,
                    studentSignUpUsername: studentSignUpUsername,
                    studentDepartment: studentDepartment,
                    studentSignUpPassword: studentSignUpPassword
                },
                dataType: "json",
                success: function(response) {
                    if (response.status === 'success') {
                        //alertify.success(response.message);
                        Swal.fire({
                            icon: 'success',
                            title: response.message,
                            showConfirmButton: false,
                            timer: 2000 
                        });
                        $('#exampleModal').modal('hide');
                    } else {
                        alertify.error(response.message);
                    }
                },
                error: function(xhr, status, error) {
                    // Handle error response
                    console.error(xhr.responseText);
                    alertify.error('Failed to sign up!');
                }
            });
        }
    }
    
    

    </script>
</body>
</html>